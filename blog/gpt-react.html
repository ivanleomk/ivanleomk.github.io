<!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Using RAG to generate UI Components"><link rel=canonical href=https://ivanleo.com/blog/gpt-react.html><link rel=prev href=a-guide-to-rwkv-v3.html><link rel=next href=learning-with-adult-responsibilities.html><link rel=alternate type=application/rss+xml title="RSS feed" href=../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../feed_rss_updated.xml><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.44"><title>GPT-React - Ivan's Blog</title><link rel=stylesheet href=../assets/stylesheets/main.0253249f.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/_mkdocstrings.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-MM8QMY5JWN"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-MM8QMY5JWN",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MM8QMY5JWN",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta property=og:type content=website><meta property=og:title content="GPT-React - Ivan's Blog"><meta property=og:description content="Using RAG to generate UI Components"><meta property=og:image content=https://ivanleo.com/assets/images/social/blog/posts/gpt-react.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta property=og:url content=https://ivanleo.com/blog/gpt-react.html><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="GPT-React - Ivan's Blog"><meta name=twitter:description content="Using RAG to generate UI Components"><meta name=twitter:image content=https://ivanleo.com/assets/images/social/blog/posts/gpt-react.png></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#introduction class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../index.html title="Ivan's Blog" class="md-header__button md-logo" aria-label="Ivan's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Ivan's Blog </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> GPT-React </span> </div> </div> </div> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../index.html class=md-tabs__link> About me </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=index.html class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../work.html class=md-tabs__link> Work with me </a> </li> <li class=md-tabs__item> <a href=../newsletter.html class=md-tabs__link> Newsletter </a> </li> <li class=md-tabs__item> <a href=../talk.html class=md-tabs__link> Talks </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../index.html title="Ivan's Blog" class="md-nav__button md-logo" aria-label="Ivan's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Ivan's Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../index.html class=md-nav__link> <span class=md-ellipsis> About me </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <a href=index.html class=md-nav__link> <span class=md-ellipsis> Index </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=archive/2025.html class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> <li class=md-nav__item> <a href=archive/2024.html class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> <li class=md-nav__item> <a href=archive/2023.html class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=category/ai.html class=md-nav__link> <span class=md-ellipsis> AI </span> </a> </li> <li class=md-nav__item> <a href=category/ai-engineering.html class=md-nav__link> <span class=md-ellipsis> AI Engineering </span> </a> </li> <li class=md-nav__item> <a href=category/advice.html class=md-nav__link> <span class=md-ellipsis> Advice </span> </a> </li> <li class=md-nav__item> <a href=category/applied-ai.html class=md-nav__link> <span class=md-ellipsis> Applied AI </span> </a> </li> <li class=md-nav__item> <a href=category/braintrust.html class=md-nav__link> <span class=md-ellipsis> Braintrust </span> </a> </li> <li class=md-nav__item> <a href=category/career.html class=md-nav__link> <span class=md-ellipsis> Career </span> </a> </li> <li class=md-nav__item> <a href=category/clustering.html class=md-nav__link> <span class=md-ellipsis> Clustering </span> </a> </li> <li class=md-nav__item> <a href=category/comfyui.html class=md-nav__link> <span class=md-ellipsis> ComfyUI </span> </a> </li> <li class=md-nav__item> <a href=category/debugging.html class=md-nav__link> <span class=md-ellipsis> Debugging </span> </a> </li> <li class=md-nav__item> <a href=category/deployment.html class=md-nav__link> <span class=md-ellipsis> Deployment </span> </a> </li> <li class=md-nav__item> <a href=category/diffusion-models.html class=md-nav__link> <span class=md-ellipsis> Diffusion Models </span> </a> </li> <li class=md-nav__item> <a href=category/documentation.html class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-nav__item> <a href=category/evals.html class=md-nav__link> <span class=md-ellipsis> Evals </span> </a> </li> <li class=md-nav__item> <a href=category/evaluation.html class=md-nav__link> <span class=md-ellipsis> Evaluation </span> </a> </li> <li class=md-nav__item> <a href=category/evaluations.html class=md-nav__link> <span class=md-ellipsis> Evaluations </span> </a> </li> <li class=md-nav__item> <a href=category/instructor.html class=md-nav__link> <span class=md-ellipsis> Instructor </span> </a> </li> <li class=md-nav__item> <a href=category/llm.html class=md-nav__link> <span class=md-ellipsis> LLM </span> </a> </li> <li class=md-nav__item> <a href=category/llms.html class=md-nav__link> <span class=md-ellipsis> LLMs </span> </a> </li> <li class=md-nav__item> <a href=category/mcps.html class=md-nav__link> <span class=md-ellipsis> MCPs </span> </a> </li> <li class=md-nav__item> <a href=category/mac.html class=md-nav__link> <span class=md-ellipsis> Mac </span> </a> </li> <li class=md-nav__item> <a href=category/machine-learning.html class=md-nav__link> <span class=md-ellipsis> Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=category/modal.html class=md-nav__link> <span class=md-ellipsis> Modal </span> </a> </li> <li class=md-nav__item> <a href=category/personal.html class=md-nav__link> <span class=md-ellipsis> Personal </span> </a> </li> <li class=md-nav__item> <a href=category/personal-development.html class=md-nav__link> <span class=md-ellipsis> Personal Development </span> </a> </li> <li class=md-nav__item> <a href=category/python.html class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=category/rag.html class=md-nav__link> <span class=md-ellipsis> RAG </span> </a> </li> <li class=md-nav__item> <a href=category/rwkv.html class=md-nav__link> <span class=md-ellipsis> RWKV </span> </a> </li> <li class=md-nav__item> <a href=category/synthetic-data.html class=md-nav__link> <span class=md-ellipsis> Synthetic Data </span> </a> </li> <li class=md-nav__item> <a href=category/testing.html class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> <li class=md-nav__item> <a href=category/trends.html class=md-nav__link> <span class=md-ellipsis> Trends </span> </a> </li> <li class=md-nav__item> <a href=category/ui-generation.html class=md-nav__link> <span class=md-ellipsis> UI Generation </span> </a> </li> <li class=md-nav__item> <a href=category/uiux.html class=md-nav__link> <span class=md-ellipsis> UI/UX </span> </a> </li> <li class=md-nav__item> <a href=category/voice.html class=md-nav__link> <span class=md-ellipsis> Voice </span> </a> </li> <li class=md-nav__item> <a href=category/walkthrough.html class=md-nav__link> <span class=md-ellipsis> Walkthrough </span> </a> </li> <li class=md-nav__item> <a href=category/whisper.html class=md-nav__link> <span class=md-ellipsis> Whisper </span> </a> </li> <li class=md-nav__item> <a href=category/langchain.html class=md-nav__link> <span class=md-ellipsis> langchain </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../work.html class=md-nav__link> <span class=md-ellipsis> Work with me </span> </a> </li> <li class=md-nav__item> <a href=../newsletter.html class=md-nav__link> <span class=md-ellipsis> Newsletter </span> </a> </li> <li class=md-nav__item> <a href=../talk.html class=md-nav__link> <span class=md-ellipsis> Talks </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> <nav class=md-nav aria-label=Introduction> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-preparation class=md-nav__link> <span class=md-ellipsis> Data Preparation </span> </a> <nav class=md-nav aria-label="Data Preparation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#generating-the-tasks class=md-nav__link> <span class=md-ellipsis> Generating the Tasks </span> </a> </li> <li class=md-nav__item> <a href=#chromadb class=md-nav__link> <span class=md-ellipsis> Chromadb </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#server class=md-nav__link> <span class=md-ellipsis> Server </span> </a> <nav class=md-nav aria-label=Server> <ul class=md-nav__list> <li class=md-nav__item> <a href=#scaffolding class=md-nav__link> <span class=md-ellipsis> Scaffolding </span> </a> </li> <li class=md-nav__item> <a href=#generating-sub-tasks class=md-nav__link> <span class=md-ellipsis> Generating Sub Tasks </span> </a> </li> <li class=md-nav__item> <a href=#getting-embeddings class=md-nav__link> <span class=md-ellipsis> Getting Embeddings </span> </a> </li> <li class=md-nav__item> <a href=#prompting-our-model class=md-nav__link> <span class=md-ellipsis> Prompting our Model </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#frontend class=md-nav__link> <span class=md-ellipsis> Frontend </span> </a> <nav class=md-nav aria-label=Frontend> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rendering-the-generated-code class=md-nav__link> <span class=md-ellipsis> Rendering the Generated Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#takeaways class=md-nav__link> <span class=md-ellipsis> Takeaways </span> </a> <nav class=md-nav aria-label=Takeaways> <ul class=md-nav__list> <li class=md-nav__item> <a href=#main-problems class=md-nav__link> <span class=md-ellipsis> Main Problems </span> </a> </li> <li class=md-nav__item> <a href=#future-improvements class=md-nav__link> <span class=md-ellipsis> Future Improvements </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <!-- Sidebar --> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <!-- Back to overview link --> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=index.html class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=https://pbs.twimg.com/profile_images/1838778744468836353/utYfioiO_400x400.jpg alt="Ivan Leo"> </span> <span class=md-profile__description> <strong> <a href="https://twitter.com/intent/follow?screen_name=ivanleomk">Ivan Leo</a> </strong> <br> Research Engineer at 567 Labs </span> </div> </div> <!-- Post metadata --> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <!-- Post date --> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg> <time datetime="2023-12-20 00:00:00" class=md-ellipsis>December 20, 2023</time> </div> </li> <!-- Post date updated --> <!-- Post categories --> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg> <span class=md-ellipsis> in <a href=category/rag.html>RAG</a>, <a href=category/ui-generation.html>UI Generation</a></span> </div> </li> <!-- Post readtime --> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg> <span class=md-ellipsis> 14 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> <!-- Table of contents, if integrated --> </div> </div> </div> <!-- Page content --> <article class="md-content__inner md-typeset"> <h1>GPT-React</h1> <h2 id=introduction>Introduction</h2> <blockquote> <p>The full code for this is avaliable <a href=https://github.com/ivanleomk/GPT-React>here</a> for reference.</p> </blockquote> <p>A while ago, I saw a demo video of Vercel's V0 and was blown away by what it could produce. It could take in user prompts, feedback and iteratively generate new and improved UI code using the popular <code>@shadcn/ui</code> library.</p> <p>This was soon followed by the <a href=https://github.com/raidendotai/openv0/ >open-v0</a> project by <a href=https://twitter.com/n_raidenai>raidendotai</a>. Since I didn't have access to v0 via vercel, i figured I would clone the project and try to figure out how it worked.</p> <p>One eventful friday evening later, I ended up putting together a small prototype which uses context-aware RAG and pydantic to generate valid NextJS Code based on a user prompt which you can see below.</p> <blockquote> <p>The Gif renders pretty slowly for some reason so if you want to see the original clip, you can check it out <a href=https://twitter.com/ivanleomk/status/1715423194973351955>here</a></p> </blockquote> <p><img alt src=images/succesful_render.gif></p> <!-- more --> <h3 id=overview>Overview</h3> <p>Let's break down how it works under the hood. On a high level, whenerver a user submits a prompt we do the following</p> <ol> <li> <p>First, we extract out a list of substasks which might be relevant to solving this problem. We also pass in a list of components and a short description for each of them into the prompt for added context.</p> </li> <li> <p>We then take these subtasks and embed them, performing a lookup on code chunks in our vector db. This vector db contains a embedding map of <code>task</code> ( which was generated by gpt 4 ) to a <code>code chunk</code> from the <code>@shadcn/ui</code> library.</p> </li> <li> <p>We then perform a deduplication on our code chunk extracted so that the model only sees each example once.</p> </li> <li> <p>We also pass in a set of Rules. These are a set of conditions which the model has to conform to.</p> </li> <li> <p>We then get the model to generate the code therefafter.</p> </li> </ol> <p>Note that the entire codebase used <code>gpt-4</code> as a default. I didn't have the time to do fine-tuning.</p> <h2 id=data-preparation>Data Preparation</h2> <p>As anyone working with LLMs will tell you, it's most important to have good quality data. In this case, that's very true.</p> <p>In my case, I chose to process the data as such</p> <ol> <li> <p>First, extract out all of the code chunks in the <code>@shadcn/ui</code> library. I used a <code>dump.json</code> file which was in the <code>open-v0</code> repository to do this.</p> </li> <li> <p>Next, for each code chunk, I got GPT-4 to generate a task that might have led to this code chunk being written.</p> </li> </ol> <p>Let's see a quick example.</p> <div class="language-js highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Input</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/components/ui/input&quot;</span><span class=p>;</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>InputDemo</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Input</span><span class=w> </span><span class=nx>type</span><span class=o>=</span><span class=s2>&quot;email&quot;</span><span class=w> </span><span class=nx>placeholder</span><span class=o>=</span><span class=s2>&quot;Email&quot;</span><span class=w> </span><span class=o>/&gt;</span><span class=p>;</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=p>}</span>
</span></code></pre></div> <p>What are some tasks that could have been assigned to a developer who submits a code chunk like this? In this case, GPT-4 came up with</p> <ul> <li>Create a new component named <code>InputDemo</code> that uses the <code>Input</code> component from the @shadcn/ui library</li> <li>Set the type of the <code>Input</code> component to <code>email</code></li> <li>Set the placeholder of the <code>Input</code> component to <code>Email</code></li> <li>Ensure the <code>InputDemo</code> component is exported as the default export</li> </ul> <p>So we perform this task generation for each and every code example that's given in the <code>@shadcn/ui</code> library. We ideally want more potential tasks so that for each code chunk, we have more potential options that we can check against when a user makes a query.</p> <h3 id=generating-the-tasks>Generating the Tasks</h3> <p>The original <code>dump.json</code> file doesn't store code chunks nicely and has a lot more metadata. So we need to first massage the data.</p> <p>This is done by using the <code>extract_examples_from_data</code> function in the source code</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>def</span> <span class=nf>extract_examples_from_data</span><span class=p>(</span><span class=n>doc_data</span><span class=p>):</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=k>return</span> <span class=p>[</span><span class=n>i</span><span class=p>[</span><span class=s2>&quot;code&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>doc_data</span><span class=p>[</span><span class=s2>&quot;docs&quot;</span><span class=p>][</span><span class=s2>&quot;examples&quot;</span><span class=p>]]</span>
</span></code></pre></div> <p>Once we've extracted the source code out, we now have a collection of code chunks. Now let's think a bit about the kind of data structure we expect back. This is where pydantic shines.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>class</span> <span class=nc>Task</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=sd>    This is a class which represents a potential task that could have resulted in the code snippet provided</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=sd>    eg. I want a button that generates a toast when it&#39;s clicked</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=sd>    eg. I want a login form which allows users to key in their email and validates that it belongs to the facebook.com domain.</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>    <span class=n>task</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s2>&quot;This is a task which might have resulted in the component&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>it's useful here to point out that the more examples you provide and the more descriptive your class definition is, the better your eventual outputs are going to be. But since we want multiple tasks instead of just one from the code chunk, we can take advantage of the <code>MultiTask</code> functionality provided in the <code>instructor</code> library.</p> <blockquote> <p>Don't forget to run <code>instructor.patch()</code> before you run your functions so you get the nice functionality it provides</p> </blockquote> <p>This allows us to query GPT-4 for multiple instances of the <code>Task</code> object by creating a new pydantic class. In our case, we'll call it <code>MultiTaskType</code> so that we don't get a naming conflict.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>MultiTaskType</span> <span class=o>=</span> <span class=n>instructor</span><span class=o>.</span><span class=n>MultiTask</span><span class=p>(</span><span class=n>Task</span><span class=p>)</span>
</span></code></pre></div> <p>We can then use this in our code as follows</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>completion</span> <span class=o>=</span> <span class=n>openai</span><span class=o>.</span><span class=n>ChatCompletion</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>        <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4&quot;</span><span class=p>,</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>        <span class=n>temperature</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>        <span class=n>stream</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>        <span class=n>max_retries</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>        <span class=n>functions</span><span class=o>=</span><span class=p>[</span><span class=n>MultiTaskType</span><span class=o>.</span><span class=n>openai_schema</span><span class=p>],</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>        <span class=n>function_call</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>MultiTaskType</span><span class=o>.</span><span class=n>openai_schema</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]},</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>        <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>        <span class=p>{</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>            <span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;system&quot;</span><span class=p>,</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>            <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;As an experienced programmer using the NextJS Framework with the @shadcn/ui and tailwindcss library, you are tasked with brainstorming some tasks that could have resulted in the following code chunk being produced.&quot;</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=p>},</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>        <span class=p>{</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>            <span class=s2>&quot;role&quot;</span><span class=p>:</span><span class=s2>&quot;assistant&quot;</span><span class=p>,</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>            <span class=s2>&quot;content&quot;</span><span class=p>:</span><span class=s2>&quot;Examples of such tasks could be adding a toast component to display temporary messages, using a specific variant avaliable in the @shadcn/ui library or configuring a component that toggles between two display states&quot;</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>        <span class=p>},</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>        <span class=p>{</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>        <span class=s2>&quot;role&quot;</span><span class=p>:</span><span class=s2>&quot;assistant&quot;</span><span class=p>,</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>        <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;Tasks should be as diverse as possible while staying relevant. Generate at most 4 Tasks.&quot;</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>            <span class=p>},</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>        <span class=p>{</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>            <span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>            <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>chunk</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>        <span class=p>},</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>        <span class=p>],</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>        <span class=n>max_tokens</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>        <span class=p>)</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=n>res</span> <span class=o>=</span> <span class=n>MultiTaskType</span><span class=o>.</span><span class=n>from_response</span><span class=p>(</span><span class=n>completion</span><span class=p>)</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=k>return</span> <span class=p>[</span><span class=n>i</span><span class=o>.</span><span class=n>task</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>list</span><span class=p>(</span><span class=n>res</span><span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]]</span>
</span></code></pre></div> <p>Notice here that we get automatic retries with the new <code>max_retries</code> parameter in the <code>openai</code> library thanks to patching openai. While running this command, since we're firing out a lot of different api calls to gpt-4, we might also get rate-limited.</p> <blockquote> <p>At the time of this article, GPT-4 has a rate-limit of approximately <code>200</code> requests per minute. Therefore, in running this script, it's very likely that you might be rate-limited for a large dataset. PLEASE BUILD RATE-LIMITING AND CHECKPOINTS INTO YOUR CODE.</p> </blockquote> <p>Therefore, I found it useful to run this function async with the following logic</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>async</span> <span class=k>def</span> <span class=nf>generate_task_given_chunk</span><span class=p>(</span><span class=n>chunk</span><span class=p>:</span><span class=nb>str</span><span class=p>,</span><span class=n>retries</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>-&gt;</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>retries</span><span class=p>):</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>          <span class=o>//</span> <span class=n>Execute</span> <span class=n>code</span> <span class=n>completion</span> <span class=n>code</span> <span class=n>here</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>          <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;----Encountered an exception&quot;</span><span class=p>)</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>          <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>          <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>60</span><span class=p>)</span>
</span></code></pre></div> <p>We can then map over all the examples in a single async call.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>code_examples</span><span class=p>:</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>extract_examples_from_data</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>mapping</span><span class=p>[</span><span class=n>key</span><span class=p>]])</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=n>loop</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>get_event_loop</span><span class=p>()</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>tasks</span> <span class=o>=</span> <span class=p>[</span><span class=n>generate_task_given_chunk</span><span class=p>(</span><span class=n>code_example</span><span class=p>)</span> <span class=k>for</span> <span class=n>code_example</span> <span class=ow>in</span> <span class=n>code_examples</span><span class=p>]</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=n>results</span> <span class=o>=</span> <span class=n>loop</span><span class=o>.</span><span class=n>run_until_complete</span><span class=p>(</span><span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>))</span>
</span></code></pre></div> <p>We then save the results at each step by using</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>for</span> <span class=n>code_example</span><span class=p>,</span> <span class=n>potential_tasks</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>code_examples</span><span class=p>,</span> <span class=n>results</span><span class=p>):</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>queries</span><span class=p>:</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>        <span class=n>queries</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>queries</span><span class=p>[</span><span class=n>key</span><span class=p>][</span><span class=n>code_example</span><span class=p>]</span> <span class=o>=</span> <span class=n>potential_tasks</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>data_dir</span><span class=p>,</span><span class=s2>&quot;w+&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>queries</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
</span></code></pre></div> <p>Running it on the entire code chunk examples took me about 10-20 minutes so just let it run and get a cup of coffee.</p> <h3 id=chromadb>Chromadb</h3> <p>While there are a lot of potential options out there, I wanted a simple to deploy vector db that I could run locally. After some research, I ended up looking at chromadb which provides a python integration and persistent data.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>pip<span class=w> </span>install<span class=w> </span>chromadb
</span></code></pre></div> <p>We can then initialise a persistent Chromadb instance by running</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>chroma_client</span> <span class=o>=</span> <span class=n>chromadb</span><span class=o>.</span><span class=n>PersistentClient</span><span class=p>(</span><span class=n>path</span><span class=o>=</span> <span class=c1>#path here)</span>
</span></code></pre></div> <p>So once we've generated the code tasks and saved it in a giant json file, we can now generate some embeddings for easy lookup. In my case, I'm storing my code in a collection called <code>task_to_chunk</code>. I delete the collection on each run of my generate script so that I end up with a fresh embedding database.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>try</span><span class=p>:</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>  <span class=n>collection</span> <span class=o>=</span> <span class=n>chroma_client</span><span class=o>.</span><span class=n>get_collection</span><span class=p>(</span><span class=n>collection_name</span><span class=p>)</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>  <span class=n>chroma_client</span><span class=o>.</span><span class=n>delete_collection</span><span class=p>(</span><span class=n>collection_name</span><span class=p>)</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>  <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Deleted </span><span class=si>{</span><span class=n>collection_name</span><span class=si>}</span><span class=s2>.&quot;</span><span class=p>)</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>  <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Collection </span><span class=si>{</span><span class=n>collection_name</span><span class=si>}</span><span class=s2> does not exist...creating now&quot;</span><span class=p>)</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=c1># We generate the task list, and we have the code. The next step is to then embed each of the individual tasks into a chromadb database</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=n>collection</span><span class=p>:</span><span class=n>chromadb</span><span class=o>.</span><span class=n>Collection</span> <span class=o>=</span> <span class=n>chroma_client</span><span class=o>.</span><span class=n>get_or_create_collection</span><span class=p>(</span><span class=n>collection_name</span><span class=p>)</span>
</span></code></pre></div> <p>We can then embed the entire list of tasks using the default settings in chromadb</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Then we embed the individual queries</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=k>for</span> <span class=n>component</span> <span class=ow>in</span> <span class=n>queries</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>    <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>queries</span><span class=p>[</span><span class=n>component</span><span class=p>]</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>        <span class=k>for</span> <span class=n>task</span> <span class=ow>in</span> <span class=n>queries</span><span class=p>[</span><span class=n>component</span><span class=p>][</span><span class=n>chunk</span><span class=p>]:</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>            <span class=nb>id</span> <span class=o>=</span> <span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>            <span class=n>collection</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>                <span class=n>documents</span><span class=o>=</span><span class=p>[</span><span class=n>task</span><span class=p>],</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>                <span class=n>metadatas</span><span class=o>=</span><span class=p>[{</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>                    <span class=s2>&quot;chunk&quot;</span><span class=p>:</span><span class=n>chunk</span><span class=p>,</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>                    <span class=s2>&quot;component&quot;</span><span class=p>:</span><span class=n>component</span><span class=p>,</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>                <span class=p>}],</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>                <span class=n>ids</span><span class=o>=</span><span class=p>[</span><span class=nb>id</span><span class=o>.</span><span class=fm>__str__</span><span class=p>()]</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>            <span class=p>)</span>
</span></code></pre></div> <p>Note here that we embed the task and then store the chunk and component as metadata for easy lookup. We also generate a unique uuid for each task we add into the database.</p> <h2 id=server>Server</h2> <h3 id=scaffolding>Scaffolding</h3> <p>We can now generate a small python server using <a href=https://fastapi.tiangolo.com>FastAPI</a>. We can initialise it by creating a simple <code>main.py</code> script as seen eblow</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Union</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=kn>import</span> <span class=nn>chromadb</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=kn>import</span> <span class=nn>dotenv</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=kn>import</span> <span class=nn>openai</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=kn>import</span> <span class=nn>os</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=n>dotenv</span><span class=o>.</span><span class=n>load_dotenv</span><span class=p>()</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=n>openai</span><span class=o>.</span><span class=n>api_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&quot;OPENAI_KEY&quot;</span><span class=p>]</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=n>chroma_client</span> <span class=o>=</span> <span class=n>chromadb</span><span class=o>.</span><span class=n>PersistentClient</span><span class=p>(</span><span class=n>path</span><span class=o>=</span><span class=s2>&quot;./chromadb&quot;</span><span class=p>)</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=n>collection</span> <span class=o>=</span> <span class=n>chroma_client</span><span class=o>.</span><span class=n>get_collection</span><span class=p>(</span><span class=s2>&quot;task_to_chunk&quot;</span><span class=p>)</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=k>class</span> <span class=nc>UserGenerationRequest</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a>    <span class=n>prompt</span><span class=p>:</span><span class=nb>str</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/&quot;</span><span class=p>)</span>
</span><span id=__span-12-20><a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=k>def</span> <span class=nf>read_root</span><span class=p>(</span><span class=n>Prompt</span><span class=p>:</span><span class=n>UserGenerationRequest</span><span class=p>):</span>
</span><span id=__span-12-21><a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a>  <span class=k>return</span> <span class=s2>&quot;OK&quot;</span>
</span></code></pre></div> <p>In our example above, we</p> <ul> <li>Loaded an Open AI API Key in the system env</li> <li>Started a chroma instance that we can query against</li> <li>Got a reference to our chromadb collection</li> </ul> <h3 id=generating-sub-tasks>Generating Sub Tasks</h3> <p>Now, that we can take in a user prompt with our endpoint, let's now generate a bunch of sub tasks</p> <p>Similar to our earlier example, we'll start by defining our pydantic model</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>class</span> <span class=nc>SubTask</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>  </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=sd>  This is a class representing a sub task that must be completed in order for the user&#39;s request to be fulfilled.</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=sd>  Eg. I want to have a login form that users can use to login with their email and password. If it&#39;s a succesful login, then we should display a small toast stating Congratulations! You&#39;ve succesfully logged in.</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=sd>  We can decompose our tasks into sub tasks such as</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=sd>  - Create a input form that takes in an email</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=sd>  - Create a primary button that has an onclick event</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=sd>  - display a toast using the useToast hook</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=sd>  and so on.</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=sd>  &quot;&quot;&quot;</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>  <span class=n>task</span><span class=p>:</span><span class=nb>str</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s2>&quot;This is an instance of a sub-task which is relevant to the user&#39;s designated task&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>We can then use the <code>MultiTask</code> function from the <code>instructor</code> library to get a variety of different tasks using the function below.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=k>def</span> <span class=nf>generate_sub_tasks</span><span class=p>(</span><span class=n>query</span><span class=p>):</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>  <span class=n>completion</span> <span class=o>=</span> <span class=n>openai</span><span class=o>.</span><span class=n>ChatCompletion</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4&quot;</span><span class=p>,</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=n>temperature</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>    <span class=n>stream</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>    <span class=n>functions</span><span class=o>=</span><span class=p>[</span><span class=n>MultiTaskObjects</span><span class=o>.</span><span class=n>openai_schema</span><span class=p>],</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>    <span class=n>function_call</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>MultiTaskObjects</span><span class=o>.</span><span class=n>openai_schema</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]},</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>    <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>        <span class=p>{</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>          <span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;system&quot;</span><span class=p>,</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>          <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;You are a senior software engineer who is very familiar with NextJS and the @shadcn/ui libary. You are about to be given a task by a user to create a new NextJS component.&quot;</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>        <span class=p>},</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a>        <span class=p>{</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>          <span class=s2>&quot;role&quot;</span><span class=p>:</span><span class=s2>&quot;assistant&quot;</span><span class=p>,</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>          <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;Before you start on your task, let&#39;s think step by step to come up with some sub-tasks that must be completed to achieve the task you are about to be given.&quot;</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>        <span class=p>},</span>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a>        <span class=p>{</span>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a>          <span class=s2>&quot;role&quot;</span><span class=p>:</span><span class=s2>&quot;assistant&quot;</span><span class=p>,</span>
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a>          <span class=s2>&quot;content&quot;</span><span class=p>:</span><span class=sa>f</span><span class=s2>&quot;Here are some of the components avaliable for use</span><span class=se>\n</span><span class=si>{</span><span class=n>COMPONENTS</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>        <span class=p>},</span>
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a>        <span class=p>{</span>
</span><span id=__span-14-22><a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a>            <span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span>
</span><span id=__span-14-23><a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a>            <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-14-24><a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a>        <span class=p>},</span>
</span><span id=__span-14-25><a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a>    <span class=p>],</span>
</span><span id=__span-14-26><a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a>    <span class=n>max_tokens</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
</span><span id=__span-14-27><a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a>  <span class=p>)</span>
</span><span id=__span-14-28><a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a>  <span class=n>queries</span> <span class=o>=</span> <span class=n>MultiTaskObjects</span><span class=o>.</span><span class=n>from_response</span><span class=p>(</span><span class=n>completion</span><span class=p>)</span>
</span><span id=__span-14-29><a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a>
</span><span id=__span-14-30><a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a>  <span class=c1># General Syntax to get the individual tasks out from the MultiTaskObjects object</span>
</span><span id=__span-14-31><a id=__codelineno-14-31 name=__codelineno-14-31 href=#__codelineno-14-31></a>  <span class=k>return</span> <span class=p>[</span><span class=n>i</span><span class=o>.</span><span class=n>task</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>list</span><span class=p>(</span><span class=n>queries</span><span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]]</span>
</span></code></pre></div> <p>Note here that we're also passing in a list of all the components that our llm has access to. This looks like</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>COMPONENTS</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=s2>-Typography:Styles for headings, paragraphs, lists...etc</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=s2>-Accordion:A vertically stacked set of interactive headings that each reveal a section of content.</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=s2>-Alert:Displays a callout for user attention.</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=s2>-Alert Dialog:A modal dialog that interrupts the user with important content and expects a response.</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=s2>-Aspect Ratio:Displays content wi</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=s2># other components go here</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=s2>&quot;&quot;&quot;</span>
</span></code></pre></div> <p>I found that this helped the LLM to make more accurate decisions when it came to sub tasks since it was able to identify precisely what components it needed. Once we've extracted out the sub tasks, we can then proceed to get the relevant code chunks by computing embeddings.</p> <h3 id=getting-embeddings>Getting Embeddings</h3> <p>I found that chromadb had a slightly awkward way of returning embeddings. Ideally I want it in a giant object which contains just the relevant code chunks but it returns it as a map of</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=p>{</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>  <span class=n>ids</span><span class=p>:</span> <span class=p>[</span><span class=n>id1</span><span class=p>,</span><span class=n>id2</span><span class=p>]</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>  <span class=n>metadatas</span><span class=p>:</span> <span class=p>[</span><span class=n>metadata1</span><span class=p>,</span><span class=n>metadata2</span><span class=p>],</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>  <span class=n>embeddings</span><span class=p>:</span> <span class=p>[</span><span class=n>embedding1</span><span class=p>,</span> <span class=n>embedding2</span><span class=p>]</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=p>}</span>
</span></code></pre></div> <p>So, I wrote this little function to extract out the top 3 most relevant code chunks for our example.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=n>elevant_results</span> <span class=o>=</span> <span class=n>collection</span><span class=o>.</span><span class=n>query</span><span class=p>(</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>    <span class=n>query_texts</span><span class=o>=</span><span class=p>[</span><span class=n>user_prompt</span><span class=p>],</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>    <span class=n>n_results</span><span class=o>=</span><span class=mi>3</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=p>)</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=n>ctx</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=n>uniq</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>relevant_results</span><span class=p>[</span><span class=s2>&quot;metadatas&quot;</span><span class=p>])):</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>    <span class=k>for</span> <span class=n>code_sample</span><span class=p>,</span><span class=n>sample_query</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>relevant_results</span><span class=p>[</span><span class=s2>&quot;metadatas&quot;</span><span class=p>][</span><span class=n>i</span><span class=p>],</span><span class=n>relevant_results</span><span class=p>[</span><span class=s2>&quot;documents&quot;</span><span class=p>][</span><span class=n>i</span><span class=p>]):</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>        <span class=k>if</span> <span class=n>sample_query</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>uniq</span><span class=p>:</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>            <span class=n>ctx</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Eg.</span><span class=si>{</span><span class=n>sample_query</span><span class=si>}</span><span class=se>\n</span><span class=s2>```</span><span class=si>{</span><span class=n>code_sample</span><span class=si>}</span><span class=s2>```</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>            <span class=n>uniq</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>sample_query</span><span class=p>)</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=n>ctx_string</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>ctx</span><span class=p>)</span>
</span></code></pre></div> <blockquote> <p>Note here that I'm using the sample_query instead of the code chunk as the unique key for deduplication. This is intentional. I thought that it would be useful to provide a few different ways that the same code chunk could be used.</p> </blockquote> <p>This then produces a long context string that looks like this</p> <blockquote> <p>Eg. How to code an input box</p> <div class="language-js highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1>// code chunk goes here</span>
</span></code></pre></div> </blockquote> <p>Which we compile and feed in as context.</p> <h3 id=prompting-our-model>Prompting our Model</h3> <p>I found that by using a vanilla prompt, GPT-4 tended to return either</p> <ol> <li>Invalid Code - it would hallucinate and create imports from other libraries such as <code>@chakra-ui</code></li> <li>It would return a short remark before giving me the actual code (Eg. Sure, I can give you the code ... (react code goes here ))</li> </ol> <p>In order to fix this, I implemented two solutions</p> <ol> <li> <p>Rules - these are pieces of information that the model needs to follow. I thought it would be more useful to add it at the end of the prompt because models tend to add additional weight to information placed at the start and end of their prompts</p> </li> <li> <p>A Pydantic Model - This would force it to return code</p> </li> </ol> <p>Rules were not overly complex, I ended up using the following after some experimentation. These are useful because libraries tend to have library-specific implementation details and having rules ensures that your model respects them</p> <blockquote> <p>Here are some rules that you must follow when generating react code</p> <ol> <li>Always add a title and description to a toast</li> </ol> <div class="language-js highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=w>   </span><span class=nx>onClick</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-19-2><a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>   </span><span class=nx>toast</span><span class=p>({</span>
</span><span id=__span-19-3><a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>      </span><span class=nx>title</span><span class=o>:</span><span class=w> </span><span class=c1>// title goes here,</span>
</span><span id=__span-19-4><a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>    </span><span class=nx>description</span><span class=o>:</span><span class=w> </span><span class=c1>// description,</span>
</span><span id=__span-19-5><a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>    </span><span class=p>})</span>
</span><span id=__span-19-6><a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=p>}}</span>
</span></code></pre></div> <ol> <li> <p>Make sure to only use imports that follow the following pattern</p> </li> <li> <p>'React'</p> </li> <li>'@/components/ui/componentName`</li> <li> <p>'next/'</p> </li> <li> <p>No other libraries are allowed to be used</p> </li> </ol> </blockquote> <p>In terms of the pydantic model, I didn't use anything overtly complex.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=k>class</span> <span class=nc>CodeResult</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=w>  </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=sd>  This is a class representing the generated code from a user&#39;s query. This should only include valid React Code that uses the @shadcn/ui library. Please make to conform to the examples shown</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=sd>  &quot;&quot;&quot;</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>  <span class=n>code</span><span class=p>:</span><span class=nb>str</span>
</span></code></pre></div> <p>I found that the above code definition was good enough to achieve consistent react code generated throughout all my individual tests. I then utilised gpt-4 to generated the code</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=k>def</span> <span class=nf>generate_code</span><span class=p>(</span><span class=n>ctx_string</span><span class=p>,</span><span class=n>user_prompt</span><span class=p>):</span>
</span><span id=__span-21-2><a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>  <span class=n>gen_code</span><span class=p>:</span> <span class=n>CodeResult</span> <span class=o>=</span> <span class=n>openai</span><span class=o>.</span><span class=n>ChatCompletion</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span><span id=__span-21-3><a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4&quot;</span><span class=p>,</span>
</span><span id=__span-21-4><a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>    <span class=n>response_model</span><span class=o>=</span><span class=n>CodeResult</span><span class=p>,</span>
</span><span id=__span-21-5><a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>    <span class=n>max_retries</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-21-6><a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>    <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
</span><span id=__span-21-7><a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a>        <span class=p>{</span>
</span><span id=__span-21-8><a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>          <span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;system&quot;</span><span class=p>,</span>
</span><span id=__span-21-9><a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>          <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;You are a NextJS expert programmer. You are about to be given a task by a user to fulfil an objective using only components and methods found in the examples below.&quot;</span>
</span><span id=__span-21-10><a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>        <span class=p>},</span>
</span><span id=__span-21-11><a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>        <span class=p>{</span>
</span><span id=__span-21-12><a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>            <span class=s2>&quot;role&quot;</span><span class=p>:</span><span class=s2>&quot;assistant&quot;</span><span class=p>,</span>
</span><span id=__span-21-13><a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>            <span class=s2>&quot;content&quot;</span><span class=p>:</span><span class=sa>f</span><span class=s2>&quot;Here are some relevant examples that you should refer to. Only use information from the example. Do not invent or make anything up.</span><span class=se>\n</span><span class=s2> </span><span class=si>{</span><span class=n>ctx_string</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-21-14><a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a>        <span class=p>},</span>
</span><span id=__span-21-15><a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>        <span class=p>{</span>
</span><span id=__span-21-16><a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>          <span class=s2>&quot;role&quot;</span><span class=p>:</span><span class=s2>&quot;assistant&quot;</span><span class=p>,</span>
</span><span id=__span-21-17><a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a>          <span class=s2>&quot;content&quot;</span><span class=p>:</span><span class=sa>f</span><span class=s2>&quot;Please adhere to the following rules when generating components</span><span class=se>\n</span><span class=s2> </span><span class=si>{</span><span class=n>RULES</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-21-18><a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a>        <span class=p>},</span>
</span><span id=__span-21-19><a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a>        <span class=p>{</span>
</span><span id=__span-21-20><a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a>            <span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span>
</span><span id=__span-21-21><a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a>            <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>user_prompt</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
</span><span id=__span-21-22><a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a>        <span class=p>},</span>
</span><span id=__span-21-23><a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a>    <span class=p>]</span>
</span><span id=__span-21-24><a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a>  <span class=p>)</span>
</span><span id=__span-21-25><a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a>  <span class=k>return</span> <span class=n>gen_code</span><span class=o>.</span><span class=n>code</span>
</span></code></pre></div> <h2 id=frontend>Frontend</h2> <h3 id=rendering-the-generated-code>Rendering the Generated Code</h3> <p>The Frontend proved to be a little bit difficult because nextjs would not allow me to inject in the react code generated. This makes sense since normally, we write react code, which is then bundled into a source map and javascript files before it's rendered in the browser.</p> <p>So, as a workaround, I realised that I could use a client side dynamic import to render a component. On the backend, we can support this by adding the following snippet into our route.</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;../src/generated/component.tsx&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>generated_code</span><span class=p>)</span>
</span></code></pre></div> <p>We can then import in this component on the frontend by defining a dynamicly imported component in nextjs</p> <div class="language-js highlight"><pre><span></span><code><span id=__span-23-1><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=k>import</span><span class=w> </span><span class=nx>dynamic</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;next/dynamic&quot;</span><span class=p>;</span>
</span><span id=__span-23-2><a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
</span><span id=__span-23-3><a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=kd>const</span><span class=w> </span><span class=nx>DynamicHeader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>dynamic</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=k>import</span><span class=p>(</span><span class=s2>&quot;../generated/component&quot;</span><span class=p>),</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-23-4><a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=w>  </span><span class=nx>loading</span><span class=o>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=nx>Loading</span><span class=p>...</span><span class=o>&lt;</span><span class=err>/p&gt;,</span>
</span><span id=__span-23-5><a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=w>  </span><span class=nx>ssr</span><span class=o>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=c1>// add this line to disable server-side rendering</span>
</span><span id=__span-23-6><a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=p>});</span>
</span></code></pre></div> <p>Once this was done, we could just import it like any other component and use it. I wrote up a quick and dirty client componet using server actions that would achieve this result.</p> <div class="language-js highlight"><pre><span></span><code><span id=__span-24-1><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=s2>&quot;use client&quot;</span><span class=p>;</span>
</span><span id=__span-24-2><a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Button</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/components/ui/button&quot;</span><span class=p>;</span>
</span><span id=__span-24-3><a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Input</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/components/ui/input&quot;</span><span class=p>;</span>
</span><span id=__span-24-4><a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Label</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/components/ui/label&quot;</span><span class=p>;</span>
</span><span id=__span-24-5><a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Textarea</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/components/ui/textarea&quot;</span><span class=p>;</span>
</span><span id=__span-24-6><a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useToast</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/components/ui/use-toast&quot;</span><span class=p>;</span>
</span><span id=__span-24-7><a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>ClearComponent</span><span class=p>,</span><span class=w> </span><span class=nx>SubmitPrompt</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/lib/prompt&quot;</span><span class=p>;</span>
</span><span id=__span-24-8><a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=k>import</span><span class=w> </span><span class=nx>dynamic</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;next/dynamic&quot;</span><span class=p>;</span>
</span><span id=__span-24-9><a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=k>import</span><span class=w> </span><span class=nx>React</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useTransition</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
</span><span id=__span-24-10><a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>ClipLoader</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react-spinners&quot;</span><span class=p>;</span>
</span><span id=__span-24-11><a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>Tabs</span><span class=p>,</span><span class=w> </span><span class=nx>TabsContent</span><span class=p>,</span><span class=w> </span><span class=nx>TabsList</span><span class=p>,</span><span class=w> </span><span class=nx>TabsTrigger</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;@/components/ui/tabs&quot;</span><span class=p>;</span>
</span><span id=__span-24-12><a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>
</span><span id=__span-24-13><a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a><span class=kd>const</span><span class=w> </span><span class=nx>DynamicHeader</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>dynamic</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=k>import</span><span class=p>(</span><span class=s2>&quot;../generated/component&quot;</span><span class=p>),</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-24-14><a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=w>  </span><span class=nx>loading</span><span class=o>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=nx>Loading</span><span class=p>...</span><span class=o>&lt;</span><span class=err>/p&gt;,</span>
</span><span id=__span-24-15><a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=w>  </span><span class=nx>ssr</span><span class=o>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=c1>// add this line to disable server-side rendering</span>
</span><span id=__span-24-16><a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=p>});</span>
</span><span id=__span-24-17><a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a>
</span><span id=__span-24-18><a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a><span class=kd>const</span><span class=w> </span><span class=nx>UserInput</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-24-19><a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a><span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isPending</span><span class=p>,</span><span class=w> </span><span class=nx>startTransition</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useTransition</span><span class=p>();</span>
</span><span id=__span-24-20><a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a><span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>userInput</span><span class=p>,</span><span class=w> </span><span class=nx>setuserInput</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=p>);</span>
</span><span id=__span-24-21><a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a><span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>generatedCode</span><span class=p>,</span><span class=w> </span><span class=nx>setGeneratedCode</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;&quot;</span><span class=p>);</span>
</span><span id=__span-24-22><a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a>
</span><span id=__span-24-23><a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-24-24><a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a><span class=w>    </span><span class=o>&lt;</span><span class=nx>div</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;max-w-xl mx-auto&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-25><a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a><span class=w>      </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>GPT</span><span class=o>-</span><span class=mf>4</span><span class=w> </span><span class=nx>Powered</span><span class=w> </span><span class=nx>React</span><span class=w> </span><span class=nx>Components</span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
</span><span id=__span-24-26><a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a>
</span><span id=__span-24-27><a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a><span class=w>      </span><span class=o>&lt;</span><span class=nx>form</span>
</span><span id=__span-24-28><a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a><span class=w>        </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;my-4 &quot;</span>
</span><span id=__span-24-29><a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a><span class=w>        </span><span class=nx>onSubmit</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-24-30><a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a><span class=w>          </span><span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span><span id=__span-24-31><a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a><span class=w>          </span><span class=nx>startTransition</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-24-32><a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a><span class=w>            </span><span class=nx>SubmitPrompt</span><span class=p>(</span><span class=nx>userInput</span><span class=p>).</span><span class=nx>then</span><span class=p>((</span><span class=nx>res</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-24-33><a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a><span class=w>              </span><span class=nx>setGeneratedCode</span><span class=p>(</span><span class=nx>res</span><span class=p>[</span><span class=s2>&quot;code&quot;</span><span class=p>]);</span>
</span><span id=__span-24-34><a id=__codelineno-24-34 name=__codelineno-24-34 href=#__codelineno-24-34></a><span class=w>            </span><span class=p>});</span>
</span><span id=__span-24-35><a id=__codelineno-24-35 name=__codelineno-24-35 href=#__codelineno-24-35></a><span class=w>          </span><span class=p>});</span>
</span><span id=__span-24-36><a id=__codelineno-24-36 name=__codelineno-24-36 href=#__codelineno-24-36></a><span class=w>        </span><span class=p>}}</span>
</span><span id=__span-24-37><a id=__codelineno-24-37 name=__codelineno-24-37 href=#__codelineno-24-37></a><span class=w>      </span><span class=o>&gt;</span>
</span><span id=__span-24-38><a id=__codelineno-24-38 name=__codelineno-24-38 href=#__codelineno-24-38></a><span class=w>        </span><span class=o>&lt;</span><span class=nx>Label</span><span class=o>&gt;</span><span class=nx>Prompt</span><span class=o>&lt;</span><span class=err>/Label&gt;</span>
</span><span id=__span-24-39><a id=__codelineno-24-39 name=__codelineno-24-39 href=#__codelineno-24-39></a><span class=w>        </span><span class=o>&lt;</span><span class=nx>Textarea</span>
</span><span id=__span-24-40><a id=__codelineno-24-40 name=__codelineno-24-40 href=#__codelineno-24-40></a><span class=w>          </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>userInput</span><span class=p>}</span>
</span><span id=__span-24-41><a id=__codelineno-24-41 name=__codelineno-24-41 href=#__codelineno-24-41></a><span class=w>          </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setuserInput</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
</span><span id=__span-24-42><a id=__codelineno-24-42 name=__codelineno-24-42 href=#__codelineno-24-42></a><span class=w>          </span><span class=nx>placeholder</span><span class=o>=</span><span class=s2>&quot;I want to create a login form that...&quot;</span>
</span><span id=__span-24-43><a id=__codelineno-24-43 name=__codelineno-24-43 href=#__codelineno-24-43></a><span class=w>        </span><span class=o>/&gt;</span>
</span><span id=__span-24-44><a id=__codelineno-24-44 name=__codelineno-24-44 href=#__codelineno-24-44></a><span class=w>        </span><span class=o>&lt;</span><span class=nx>div</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;flex items-center justify-end mt-6 space-x-4&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-45><a id=__codelineno-24-45 name=__codelineno-24-45 href=#__codelineno-24-45></a><span class=w>          </span><span class=o>&lt;</span><span class=nx>Button</span><span class=w> </span><span class=nx>type</span><span class=o>=</span><span class=s2>&quot;submit&quot;</span><span class=o>&gt;</span><span class=nx>Submit</span><span class=o>&lt;</span><span class=err>/Button&gt;</span>
</span><span id=__span-24-46><a id=__codelineno-24-46 name=__codelineno-24-46 href=#__codelineno-24-46></a><span class=w>        </span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span><span id=__span-24-47><a id=__codelineno-24-47 name=__codelineno-24-47 href=#__codelineno-24-47></a><span class=w>      </span><span class=o>&lt;</span><span class=err>/form&gt;</span>
</span><span id=__span-24-48><a id=__codelineno-24-48 name=__codelineno-24-48 href=#__codelineno-24-48></a>
</span><span id=__span-24-49><a id=__codelineno-24-49 name=__codelineno-24-49 href=#__codelineno-24-49></a><span class=w>      </span><span class=p>{</span><span class=nx>isPending</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-24-50><a id=__codelineno-24-50 name=__codelineno-24-50 href=#__codelineno-24-50></a><span class=w>        </span><span class=o>&lt;&gt;</span>
</span><span id=__span-24-51><a id=__codelineno-24-51 name=__codelineno-24-51 href=#__codelineno-24-51></a><span class=w>          </span><span class=p>{</span><span class=s2>&quot; &quot;</span><span class=p>}</span>
</span><span id=__span-24-52><a id=__codelineno-24-52 name=__codelineno-24-52 href=#__codelineno-24-52></a><span class=w>          </span><span class=o>&lt;</span><span class=nx>ClipLoader</span><span class=w> </span><span class=nx>speedMultiplier</span><span class=o>=</span><span class=p>{</span><span class=mf>0.4</span><span class=p>}</span><span class=w> </span><span class=nx>size</span><span class=o>=</span><span class=p>{</span><span class=mf>30</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>span</span><span class=o>&gt;</span><span class=nx>Generating</span><span class=w> </span><span class=nx>Component</span><span class=p>...</span><span class=o>&lt;</span><span class=err>/span&gt;</span>
</span><span id=__span-24-53><a id=__codelineno-24-53 name=__codelineno-24-53 href=#__codelineno-24-53></a><span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
</span><span id=__span-24-54><a id=__codelineno-24-54 name=__codelineno-24-54 href=#__codelineno-24-54></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=nx>generatedCode</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=mf>0</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-24-55><a id=__codelineno-24-55 name=__codelineno-24-55 href=#__codelineno-24-55></a><span class=w>        </span><span class=o>&lt;</span><span class=nx>p</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;text-center&quot;</span><span class=o>&gt;</span><span class=nx>No</span><span class=w> </span><span class=nx>Component</span><span class=w> </span><span class=nx>Generated</span><span class=w> </span><span class=nx>yet</span><span class=o>&lt;</span><span class=err>/p&gt;</span>
</span><span id=__span-24-56><a id=__codelineno-24-56 name=__codelineno-24-56 href=#__codelineno-24-56></a><span class=w>      </span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-24-57><a id=__codelineno-24-57 name=__codelineno-24-57 href=#__codelineno-24-57></a><span class=w>        </span><span class=o>&lt;</span><span class=nx>Tabs</span><span class=w> </span><span class=nx>defaultValue</span><span class=o>=</span><span class=s2>&quot;code&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-58><a id=__codelineno-24-58 name=__codelineno-24-58 href=#__codelineno-24-58></a><span class=w>          </span><span class=o>&lt;</span><span class=nx>TabsList</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;grid w-full grid-cols-2&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-59><a id=__codelineno-24-59 name=__codelineno-24-59 href=#__codelineno-24-59></a><span class=w>            </span><span class=o>&lt;</span><span class=nx>TabsTrigger</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;code&quot;</span><span class=o>&gt;</span><span class=nx>Code</span><span class=o>&lt;</span><span class=err>/TabsTrigger&gt;</span>
</span><span id=__span-24-60><a id=__codelineno-24-60 name=__codelineno-24-60 href=#__codelineno-24-60></a><span class=w>            </span><span class=o>&lt;</span><span class=nx>TabsTrigger</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;component&quot;</span><span class=o>&gt;</span><span class=nx>Component</span><span class=o>&lt;</span><span class=err>/TabsTrigger&gt;</span>
</span><span id=__span-24-61><a id=__codelineno-24-61 name=__codelineno-24-61 href=#__codelineno-24-61></a><span class=w>          </span><span class=o>&lt;</span><span class=err>/TabsList&gt;</span>
</span><span id=__span-24-62><a id=__codelineno-24-62 name=__codelineno-24-62 href=#__codelineno-24-62></a><span class=w>          </span><span class=o>&lt;</span><span class=nx>TabsContent</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;code&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-63><a id=__codelineno-24-63 name=__codelineno-24-63 href=#__codelineno-24-63></a><span class=w>            </span><span class=o>&lt;</span><span class=nx>code</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;relative rounded px-[0.3rem] py-[0.2rem] font-mono text-sm&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-64><a id=__codelineno-24-64 name=__codelineno-24-64 href=#__codelineno-24-64></a><span class=w>              </span><span class=p>{</span><span class=nx>generatedCode</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s2>&quot;\n&quot;</span><span class=p>).</span><span class=nx>map</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-24-65><a id=__codelineno-24-65 name=__codelineno-24-65 href=#__codelineno-24-65></a><span class=w>                </span><span class=o>&lt;</span><span class=nx>div</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;py-1 px-4 bg-muted&quot;</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>item</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span><span id=__span-24-66><a id=__codelineno-24-66 name=__codelineno-24-66 href=#__codelineno-24-66></a><span class=w>              </span><span class=p>))}</span>
</span><span id=__span-24-67><a id=__codelineno-24-67 name=__codelineno-24-67 href=#__codelineno-24-67></a><span class=w>            </span><span class=o>&lt;</span><span class=err>/code&gt;</span>
</span><span id=__span-24-68><a id=__codelineno-24-68 name=__codelineno-24-68 href=#__codelineno-24-68></a><span class=w>          </span><span class=o>&lt;</span><span class=err>/TabsContent&gt;</span>
</span><span id=__span-24-69><a id=__codelineno-24-69 name=__codelineno-24-69 href=#__codelineno-24-69></a><span class=w>          </span><span class=o>&lt;</span><span class=nx>TabsContent</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;component&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-70><a id=__codelineno-24-70 name=__codelineno-24-70 href=#__codelineno-24-70></a><span class=w>            </span><span class=o>&lt;</span><span class=nx>div</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;mt-6 border px-6 py-6&quot;</span><span class=o>&gt;</span>
</span><span id=__span-24-71><a id=__codelineno-24-71 name=__codelineno-24-71 href=#__codelineno-24-71></a><span class=w>              </span><span class=o>&lt;</span><span class=nx>DynamicHeader</span><span class=w> </span><span class=o>/&gt;</span>
</span><span id=__span-24-72><a id=__codelineno-24-72 name=__codelineno-24-72 href=#__codelineno-24-72></a><span class=w>            </span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span><span id=__span-24-73><a id=__codelineno-24-73 name=__codelineno-24-73 href=#__codelineno-24-73></a><span class=w>          </span><span class=o>&lt;</span><span class=err>/TabsContent&gt;</span>
</span><span id=__span-24-74><a id=__codelineno-24-74 name=__codelineno-24-74 href=#__codelineno-24-74></a><span class=w>        </span><span class=o>&lt;</span><span class=err>/Tabs&gt;</span>
</span><span id=__span-24-75><a id=__codelineno-24-75 name=__codelineno-24-75 href=#__codelineno-24-75></a><span class=w>      </span><span class=p>)}</span>
</span><span id=__span-24-76><a id=__codelineno-24-76 name=__codelineno-24-76 href=#__codelineno-24-76></a><span class=w>    </span><span class=o>&lt;</span><span class=err>/div&gt;</span>
</span><span id=__span-24-77><a id=__codelineno-24-77 name=__codelineno-24-77 href=#__codelineno-24-77></a><span class=w>  </span><span class=p>);</span>
</span><span id=__span-24-78><a id=__codelineno-24-78 name=__codelineno-24-78 href=#__codelineno-24-78></a><span class=p>};</span>
</span><span id=__span-24-79><a id=__codelineno-24-79 name=__codelineno-24-79 href=#__codelineno-24-79></a>
</span><span id=__span-24-80><a id=__codelineno-24-80 name=__codelineno-24-80 href=#__codelineno-24-80></a><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=nx>UserInput</span><span class=p>;</span>
</span></code></pre></div> <h2 id=takeaways>Takeaways</h2> <p>This was a very fun project to implement as a quick weekend hack and again, it is not production level code at all, not even close.</p> <h3 id=main-problems>Main Problems</h3> <p>I think there are a few main things that plague this project</p> <ol> <li>A lack of bundler validation</li> <li>Insufficent Data</li> <li>Hacky way of rendering components</li> </ol> <p>One of the best ways to validate the react code is to have access to a javascript bundler which can deterministically tell you if a given chunk of code is valid or not.</p> <p>However, I'm not too sure how to do that at all using python. As a result, sometimes we would end up with code that was almost correct but was missing a few imports. This would have been easy to catch if we had access to a bundler</p> <p>Another thing that my model suffers from is that of a simple dataset. The embedding search and lookup is as good as the quality of examples that we feed into it. However, since the tasks are being manually generated by GPT-4 and we have no easy way of evolving the given examples into more complex ones without spending more time on it, this limits the ability of our model to generate complex examples.</p> <p>I personally found that when we gave it more complex examples, it started making references to objects it didn't know how to mock. Code like the following would be generated</p> <div class="language-js highlight"><pre><span></span><code><span id=__span-25-1><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=o>&lt;</span><span class=nx>span</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>user</span><span class=p>.</span><span class=nx>email</span><span class=p>}</span><span class=o>&lt;</span><span class=sr>/span&gt; /</span><span class=o>/</span><span class=w> </span><span class=nx>user</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=nx>not</span><span class=w> </span><span class=nx>mocked</span><span class=w> </span><span class=nx>at</span><span class=w> </span><span class=nx>all</span><span class=p>,</span><span class=w> </span><span class=nx>throwing</span><span class=w> </span><span class=nx>an</span><span class=w> </span><span class=nx>error</span>
</span></code></pre></div> <p>Lastly, rendering components using a dynamic import is very hacky. I personally don't think it's the best way but I was unable to think of an easy way to bundle the generated code and injecting it as html to my endpoint.</p> <h3 id=future-improvements>Future Improvements</h3> <p>If I had more time to work on this, I'd probably work on the following things</p> <ol> <li> <p>Fine Tuning : A large chunk of these tasks can probably rely on a well tuned gpt3.5 model. Examples could be generating small and specific task files (Eg. helper functions, simple input and label forms)</p> </li> <li> <p>Using a LLM Validator : I recently learnt that <code>instructor</code> also provides a <code>llm_validator</code> class that you can validate outputs against. That might have been a better place to use the rules validation that we defined.</p> </li> <li> <p>Using multiple agents : I think that this project is best served if we could look towards more specialised agents for specific tasks (Eg. One for design, one for planning, another for writing tests etc). Lindy does something similiar with calendar and emails.</p> </li> <li> <p>Dataset Improvements : It would be interesting to use something like evol-instruct to come up with either more complex prompts in our database or more complex code examples that show how to build increasingly difficult schemas. I strongly believe this would have improved the quality of the generatde output.</p> </li> </ol> <!-- Add social sharing buttons --> <div class=md-social-share style="margin: 2rem 0; text-align: center"> <span class=md-social-share__label style="display: block; margin-bottom: 1rem; font-weight: 500">Share this post:</span> <div class=md-social-share__buttons style="display: flex; gap: 1rem; justify-content: center"> <a href="https://x.com/intent/tweet?text=GPT-React&url=https://ivanleo.com/blog/gpt-react.html" class=md-social-share__button style="
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background: #000;
            color: #fff;
            text-decoration: none;
            transition: opacity 0.2s;
          " target=_blank rel=noopener> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"/></svg> <span style="margin-left: 0.5rem">Share on X</span> </a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ivanleo.com/blog/gpt-react.html&title=GPT-React&summary=&source=" class=md-social-share__button style="
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background: #0077b5;
            color: #fff;
            text-decoration: none;
            transition: opacity 0.2s;
          " target=_blank rel=noopener> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.06 2.06 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065m1.782 13.019H3.555V9h3.564zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0z"/></svg> <span style="margin-left: 0.5rem">Share on LinkedIn</span> </a> </div> </div> <div class=newsletter-section style="margin: 2rem 0"> <script async data-uid=b184c2f91e src=https://ivan-leo.kit.com/b184c2f91e/index.js></script> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.copy", "content.code.annotate", "navigation.tabs", "toc.follow", "navigation.path"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.83f73b43.min.js></script> <script src=../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>