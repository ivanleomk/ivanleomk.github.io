<!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Grokking simple statistical analysis for LLM evals"><link rel=canonical href=https://ivanleo.com/blog/are-your-eval-improvements-just-pure-chance.html><link rel=prev href=what-makes-good-documentation.html><link rel=next href=taming-your-llm-application.html><link rel=alternate type=application/rss+xml title="RSS feed" href=../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../feed_rss_updated.xml><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.44"><title>Are your eval improvements just pure chance? - Ivan's Blog</title><link rel=stylesheet href=../assets/stylesheets/main.0253249f.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/_mkdocstrings.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-MM8QMY5JWN"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-MM8QMY5JWN",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MM8QMY5JWN",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta property=og:type content=website><meta property=og:title content="Are your eval improvements just pure chance? - Ivan's Blog"><meta property=og:description content="Grokking simple statistical analysis for LLM evals"><meta property=og:image content=https://ivanleo.com/assets/images/social/blog/posts/report-error-bars.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta property=og:url content=https://ivanleo.com/blog/are-your-eval-improvements-just-pure-chance.html><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Are your eval improvements just pure chance? - Ivan's Blog"><meta name=twitter:description content="Grokking simple statistical analysis for LLM evals"><meta name=twitter:image content=https://ivanleo.com/assets/images/social/blog/posts/report-error-bars.png></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#are-your-eval-improvements-just-pure-chance class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../index.html title="Ivan's Blog" class="md-header__button md-logo" aria-label="Ivan's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Ivan's Blog </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Are your eval improvements just pure chance? </span> </div> </div> </div> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../index.html class=md-tabs__link> About me </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=index.html class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../work.html class=md-tabs__link> Work with me </a> </li> <li class=md-tabs__item> <a href=../newsletter.html class=md-tabs__link> Newsletter </a> </li> <li class=md-tabs__item> <a href=../talk.html class=md-tabs__link> Talks </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../index.html title="Ivan's Blog" class="md-nav__button md-logo" aria-label="Ivan's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Ivan's Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../index.html class=md-nav__link> <span class=md-ellipsis> About me </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <a href=index.html class=md-nav__link> <span class=md-ellipsis> Index </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=archive/2025.html class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> <li class=md-nav__item> <a href=archive/2024.html class=md-nav__link> <span class=md-ellipsis> 2024 </span> </a> </li> <li class=md-nav__item> <a href=archive/2023.html class=md-nav__link> <span class=md-ellipsis> 2023 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=category/ai.html class=md-nav__link> <span class=md-ellipsis> AI </span> </a> </li> <li class=md-nav__item> <a href=category/ai-engineering.html class=md-nav__link> <span class=md-ellipsis> AI Engineering </span> </a> </li> <li class=md-nav__item> <a href=category/advice.html class=md-nav__link> <span class=md-ellipsis> Advice </span> </a> </li> <li class=md-nav__item> <a href=category/applied-ai.html class=md-nav__link> <span class=md-ellipsis> Applied AI </span> </a> </li> <li class=md-nav__item> <a href=category/braintrust.html class=md-nav__link> <span class=md-ellipsis> Braintrust </span> </a> </li> <li class=md-nav__item> <a href=category/career.html class=md-nav__link> <span class=md-ellipsis> Career </span> </a> </li> <li class=md-nav__item> <a href=category/clustering.html class=md-nav__link> <span class=md-ellipsis> Clustering </span> </a> </li> <li class=md-nav__item> <a href=category/comfyui.html class=md-nav__link> <span class=md-ellipsis> ComfyUI </span> </a> </li> <li class=md-nav__item> <a href=category/debugging.html class=md-nav__link> <span class=md-ellipsis> Debugging </span> </a> </li> <li class=md-nav__item> <a href=category/deployment.html class=md-nav__link> <span class=md-ellipsis> Deployment </span> </a> </li> <li class=md-nav__item> <a href=category/diffusion-models.html class=md-nav__link> <span class=md-ellipsis> Diffusion Models </span> </a> </li> <li class=md-nav__item> <a href=category/documentation.html class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-nav__item> <a href=category/evals.html class=md-nav__link> <span class=md-ellipsis> Evals </span> </a> </li> <li class=md-nav__item> <a href=category/evaluation.html class=md-nav__link> <span class=md-ellipsis> Evaluation </span> </a> </li> <li class=md-nav__item> <a href=category/evaluations.html class=md-nav__link> <span class=md-ellipsis> Evaluations </span> </a> </li> <li class=md-nav__item> <a href=category/instructor.html class=md-nav__link> <span class=md-ellipsis> Instructor </span> </a> </li> <li class=md-nav__item> <a href=category/llm.html class=md-nav__link> <span class=md-ellipsis> LLM </span> </a> </li> <li class=md-nav__item> <a href=category/llms.html class=md-nav__link> <span class=md-ellipsis> LLMs </span> </a> </li> <li class=md-nav__item> <a href=category/mcps.html class=md-nav__link> <span class=md-ellipsis> MCPs </span> </a> </li> <li class=md-nav__item> <a href=category/mac.html class=md-nav__link> <span class=md-ellipsis> Mac </span> </a> </li> <li class=md-nav__item> <a href=category/machine-learning.html class=md-nav__link> <span class=md-ellipsis> Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=category/modal.html class=md-nav__link> <span class=md-ellipsis> Modal </span> </a> </li> <li class=md-nav__item> <a href=category/personal.html class=md-nav__link> <span class=md-ellipsis> Personal </span> </a> </li> <li class=md-nav__item> <a href=category/personal-development.html class=md-nav__link> <span class=md-ellipsis> Personal Development </span> </a> </li> <li class=md-nav__item> <a href=category/python.html class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=category/rag.html class=md-nav__link> <span class=md-ellipsis> RAG </span> </a> </li> <li class=md-nav__item> <a href=category/rwkv.html class=md-nav__link> <span class=md-ellipsis> RWKV </span> </a> </li> <li class=md-nav__item> <a href=category/synthetic-data.html class=md-nav__link> <span class=md-ellipsis> Synthetic Data </span> </a> </li> <li class=md-nav__item> <a href=category/testing.html class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> <li class=md-nav__item> <a href=category/trends.html class=md-nav__link> <span class=md-ellipsis> Trends </span> </a> </li> <li class=md-nav__item> <a href=category/ui-generation.html class=md-nav__link> <span class=md-ellipsis> UI Generation </span> </a> </li> <li class=md-nav__item> <a href=category/uiux.html class=md-nav__link> <span class=md-ellipsis> UI/UX </span> </a> </li> <li class=md-nav__item> <a href=category/voice.html class=md-nav__link> <span class=md-ellipsis> Voice </span> </a> </li> <li class=md-nav__item> <a href=category/walkthrough.html class=md-nav__link> <span class=md-ellipsis> Walkthrough </span> </a> </li> <li class=md-nav__item> <a href=category/whisper.html class=md-nav__link> <span class=md-ellipsis> Whisper </span> </a> </li> <li class=md-nav__item> <a href=category/langchain.html class=md-nav__link> <span class=md-ellipsis> langchain </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../work.html class=md-nav__link> <span class=md-ellipsis> Work with me </span> </a> </li> <li class=md-nav__item> <a href=../newsletter.html class=md-nav__link> <span class=md-ellipsis> Newsletter </span> </a> </li> <li class=md-nav__item> <a href=../talk.html class=md-nav__link> <span class=md-ellipsis> Talks </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#why-rag-metrics-matter class=md-nav__link> <span class=md-ellipsis> Why RAG metrics matter </span> </a> <nav class=md-nav aria-label="Why RAG metrics matter"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#looking-to-the-future class=md-nav__link> <span class=md-ellipsis> Looking to the Future </span> </a> </li> <li class=md-nav__item> <a href=#business-driven-evaluation class=md-nav__link> <span class=md-ellipsis> Business-Driven Evaluation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#comparing-three-retrieval-methods class=md-nav__link> <span class=md-ellipsis> Comparing Three Retrieval Methods </span> </a> </li> <li class=md-nav__item> <a href=#measuring-uncertainty-with-bootstrapping class=md-nav__link> <span class=md-ellipsis> Measuring Uncertainty with Bootstrapping </span> </a> <nav class=md-nav aria-label="Measuring Uncertainty with Bootstrapping"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#simplifying-bootstrap-analysis-with-indomee class=md-nav__link> <span class=md-ellipsis> Simplifying Bootstrap Analysis with indomee </span> </a> </li> <li class=md-nav__item> <a href=#computing-metrics-at-different-k-values class=md-nav__link> <span class=md-ellipsis> Computing metrics at different k values </span> </a> </li> <li class=md-nav__item> <a href=#working-with-raw-bootstrap-data class=md-nav__link> <span class=md-ellipsis> Working with Raw Bootstrap Data </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-for-statistical-significance class=md-nav__link> <span class=md-ellipsis> Testing for Statistical Significance </span> </a> <nav class=md-nav aria-label="Testing for Statistical Significance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#simplifying-t-tests-with-indomee class=md-nav__link> <span class=md-ellipsis> Simplifying t-tests with indomee </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> Conclusion </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <!-- Sidebar --> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <!-- Back to overview link --> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=index.html class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=https://pbs.twimg.com/profile_images/1838778744468836353/utYfioiO_400x400.jpg alt="Ivan Leo"> </span> <span class=md-profile__description> <strong> <a href="https://twitter.com/intent/follow?screen_name=ivanleomk">Ivan Leo</a> </strong> <br> Research Engineer at 567 Labs </span> </div> </div> <!-- Post metadata --> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <!-- Post date --> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg> <time datetime="2024-12-04 00:00:00" class=md-ellipsis>December 4, 2024</time> </div> </li> <!-- Post date updated --> <!-- Post categories --> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg> <span class=md-ellipsis> in <a href=category/llms.html>LLMs</a>, <a href=category/evals.html>Evals</a></span> </div> </li> <!-- Post readtime --> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg> <span class=md-ellipsis> 8 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> <!-- Table of contents, if integrated --> </div> </div> </div> <!-- Page content --> <article class="md-content__inner md-typeset"> <h1 id=are-your-eval-improvements-just-pure-chance>Are your eval improvements just pure chance?</h1> <p>A step that's often missed when benchmarking retrieval methods is determining if any performance difference is due to random chance. Without this crucial step, you might invest in a new system upgrade that's outperformed your old one by pure chance.</p> <p>If you're comparing retrieval methods, you'll often want to know if the improvements you're seeing are due to random chance.</p> <p>In this article, we'll use a simple case study to demonstrate how to answer this question, introducing a new library called <code>indomee</code> (a playful nod to both "in-domain" evaluation and the beloved instant noodle brand in Southeast Asia) that makes this analysis significantly easier.</p> <p>We'll do so in three steps:</p> <ol> <li>First we'll simulate some fake data using <code>numpy</code></li> <li>Then we'll demonstrate how to do bootstrapping using nothing but <code>numpy</code> before visualising the results with <code>matplotlib</code></li> <li>Finally we'll perform a paired t-test to determine if the differences are statistically significant</li> </ol> <!-- more --> <p>Let's start by installing the necessary libraries:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>pip<span class=w> </span>install<span class=w> </span>indomee<span class=w> </span>numpy<span class=w> </span>pandas<span class=w> </span>scipy<span class=w> </span>matplotlib
</span></code></pre></div> <h2 id=why-rag-metrics-matter>Why RAG metrics matter</h2> <p>Before diving into the statistical analysis, let's understand why these metrics matter for Retrieval Augmented Generation (RAG):</p> <h3 id=looking-to-the-future>Looking to the Future</h3> <p>As LLMs become more capable, two key trends are emerging:</p> <ul> <li>Improved context understanding: Newer models are getting better at identifying and utilizing relevant information from their context window</li> <li>Longer context windows: Gemini has a context window that can take 2 million tokens - that's the entire harry potter series multiplied by 10 times over and a bit more.</li> </ul> <p>This means that:</p> <ol> <li>Having high-quality retrieval becomes even more critical - better models can make better use of good context</li> <li>We can afford to retrieve more documents since context windows are expanding</li> <li>The cost of retrieving irrelevant documents is decreasing (as models get better at ignoring noise)</li> </ol> <p>This is why measuring both recall and position (through MRR) is crucial:</p> <ul> <li> <p><strong>Recall@k</strong>: Measures whether relevant documents appear in the top k retrieved results. For RAG, high recall is crucial because even if relevant information is mixed with some noise, newer models are increasingly good at finding and using it. A recall@5 of 0.8 means that 80% of the time, the relevant document appears in the top 5 results.</p> </li> <li> <p><strong>Mean Reciprocal Rank (MRR)</strong>: Focuses on where the first relevant document appears in the results. Even with longer context windows, having relevant information appear earlier helps ensure it won't get truncated and gives models the best chance of using it effectively.</p> </li> </ul> <h3 id=business-driven-evaluation>Business-Driven Evaluation</h3> <p>The specific k values you choose for evaluation should be driven by your business needs:</p> <ul> <li>Search engines might care about recall@25 or higher since users can scroll through results</li> <li>Recommendation Systems might prioritize recall@5 since they need to be concise</li> <li>Research assistants might use recall@50+ to gather extensive information</li> </ul> <p>This is why being able to calculate metrics at different k values is crucial - it lets you align your evaluation with your specific use case. Most importantly, it allows you to see whether how retrieval performs at different k values.</p> <h2 id=comparing-three-retrieval-methods>Comparing Three Retrieval Methods</h2> <p>Let's say you're comparing three retrieval methods based off recall@10. This is a metric between 0 and 1 that measures how many relevant items are retrieved in the top 10 results.</p> <p>You have the following three methods:</p> <ul> <li>Baseline: Your current approach</li> <li>Method 1: A promising new approach</li> <li>Method 2: Another alternative</li> </ul> <p>Since we don't have real data, we'll simulate some fake data using <code>numpy</code>. We'll use a normal distribution to generate random scores and then ensure they're between 0 and 1 using <code>clip(0,1)</code>:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=c1># Simulate data for 200 test queries</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=n>n_tests</span> <span class=o>=</span> <span class=mi>200</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=n>baseline</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mf>0.4</span><span class=p>,</span> <span class=mf>0.08</span><span class=p>,</span> <span class=n>n_tests</span><span class=p>)</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=n>method_1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mf>0.45</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=n>n_tests</span><span class=p>)</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=n>method_2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mf>0.49</span><span class=p>,</span> <span class=mf>0.14</span><span class=p>,</span> <span class=n>n_tests</span><span class=p>)</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    <span class=s2>&quot;test_id&quot;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_tests</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    <span class=s2>&quot;baseline&quot;</span><span class=p>:</span> <span class=n>baseline</span><span class=p>,</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>    <span class=s2>&quot;method_1&quot;</span><span class=p>:</span> <span class=n>method_1</span><span class=p>,</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>    <span class=s2>&quot;method_2&quot;</span><span class=p>:</span> <span class=n>method_2</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=p>})</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=c1># Initial data simulation output</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=n>test_id</span>     <span class=mf>100.50</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=n>baseline</span>      <span class=mf>0.40</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=n>method_1</span>      <span class=mf>0.46</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=n>method_2</span>      <span class=mf>0.48</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=n>dtype</span><span class=p>:</span> <span class=n>float64</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=c1># Shows the mean values for each method - baseline performs worst, method_2 performs best</span>
</span></code></pre></div> <p>Looking at the means:</p> <ul> <li>Method 2 is 20% better than baseline</li> <li>Method 2 is 4% better than Method 1</li> </ul> <p>But is Method 2 really better, or is this just random chance?</p> <p>We need two things to answer this:</p> <ol> <li>Bootstrapping to estimate confidence intervals</li> <li>Statistical tests to validate the differences</li> </ol> <h2 id=measuring-uncertainty-with-bootstrapping>Measuring Uncertainty with Bootstrapping</h2> <p>Bootstrapping helps us understand how much our results might change if we ran the experiment again. It works by creating new datasets from our original dataset by randomly selecting samples with replacement. Sampling with replacement means that an item in our original dataset can be selected more than once when we're selecting samples.</p> <p>By repeating this multiple times, we can create a large diversity of potential outcomes. In the code snippet below, we repeat this 1000 times, allowing us to see how stable or uncertain our results are:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>SAMPLE_SIZE</span> <span class=o>=</span> <span class=mi>200</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>NUM_SAMPLES</span> <span class=o>=</span> <span class=mi>1000</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=c1># Lists to store bootstrapped means</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>baseline_means</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>method_1_means</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=n>method_2_means</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=c1># Perform bootstrapping</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>NUM_SAMPLES</span><span class=p>):</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>    <span class=n>sample</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>SAMPLE_SIZE</span><span class=p>,</span> <span class=n>replace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>    <span class=n>baseline_means</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sample</span><span class=p>[</span><span class=s2>&quot;baseline&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>    <span class=n>method_1_means</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sample</span><span class=p>[</span><span class=s2>&quot;method_1&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>    <span class=n>method_2_means</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sample</span><span class=p>[</span><span class=s2>&quot;method_2&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=c1># Compute mean of bootstrapped samples</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=n>method_names</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Baseline&#39;</span><span class=p>,</span> <span class=s1>&#39;Method 1&#39;</span><span class=p>,</span> <span class=s1>&#39;Method 2&#39;</span><span class=p>]</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=n>all_means</span> <span class=o>=</span> <span class=p>[</span><span class=n>baseline_means</span><span class=p>,</span> <span class=n>method_1_means</span><span class=p>,</span> <span class=n>method_2_means</span><span class=p>]</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=n>mean_estimates</span> <span class=o>=</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>means</span><span class=p>)</span> <span class=k>for</span> <span class=n>means</span> <span class=ow>in</span> <span class=n>all_means</span><span class=p>]</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=c1># Calculate confidence intervals</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=n>ci_lower</span> <span class=o>=</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>means</span><span class=p>,</span> <span class=mf>2.5</span><span class=p>)</span> <span class=k>for</span> <span class=n>means</span> <span class=ow>in</span> <span class=n>all_means</span><span class=p>]</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=n>ci_upper</span> <span class=o>=</span> <span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>means</span><span class=p>,</span> <span class=mf>97.5</span><span class=p>)</span> <span class=k>for</span> <span class=n>means</span> <span class=ow>in</span> <span class=n>all_means</span><span class=p>]</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=n>error</span> <span class=o>=</span> <span class=p>[[</span><span class=n>m</span> <span class=o>-</span> <span class=n>l</span> <span class=k>for</span> <span class=n>m</span><span class=p>,</span> <span class=n>l</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>mean_estimates</span><span class=p>,</span> <span class=n>ci_lower</span><span class=p>)],</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>         <span class=p>[</span><span class=n>u</span> <span class=o>-</span> <span class=n>m</span> <span class=k>for</span> <span class=n>m</span><span class=p>,</span> <span class=n>u</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>mean_estimates</span><span class=p>,</span> <span class=n>ci_upper</span><span class=p>)]]</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=c1># Plotting code</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>8</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>method_names</span><span class=p>)),</span> <span class=n>mean_estimates</span><span class=p>,</span> <span class=n>yerr</span><span class=o>=</span><span class=n>error</span><span class=p>,</span> <span class=n>align</span><span class=o>=</span><span class=s1>&#39;center&#39;</span><span class=p>,</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a>        <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>,</span> <span class=n>capsize</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;skyblue&#39;</span><span class=p>)</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=n>plt</span><span class=o>.</span><span class=n>xticks</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>method_names</span><span class=p>)),</span> <span class=n>method_names</span><span class=p>)</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Mean Value&#39;</span><span class=p>)</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Bootstrap Confidence Intervals&#39;</span><span class=p>)</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span></code></pre></div> <h3 id=simplifying-bootstrap-analysis-with-indomee>Simplifying Bootstrap Analysis with <code>indomee</code></h3> <p>Now that we've seen how to perform bootstrapping manually, let's see how indomee simplifies this process.</p> <p>Previously, you'd need all that bootstrapping code. With indomee, it's just:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>from</span> <span class=nn>indomee</span> <span class=kn>import</span> <span class=n>bootstrap_from_results</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=n>baseline_stats</span> <span class=o>=</span> <span class=n>bootstrap_from_results</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s2>&quot;baseline&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=n>method_1_stats</span> <span class=o>=</span> <span class=n>bootstrap_from_results</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s2>&quot;method_1&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=n>method_2_stats</span> <span class=o>=</span> <span class=n>bootstrap_from_results</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s2>&quot;method_2&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=c1># Bootstrap metric output</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=nb>print</span><span class=p>(</span><span class=n>baseline_stats</span><span class=p>)</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=n>BootstrapMetric</span><span class=p>(</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=n>name</span><span class=o>=</span><span class=s1>&#39;bootstrap_metric&#39;</span><span class=p>,</span>  <span class=c1># Identifier for the metric</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>    <span class=n>value</span><span class=o>=</span><span class=mf>0.47800829518587357</span><span class=p>,</span>  <span class=c1># Mean value across all bootstrap samples</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>    <span class=n>ci_lower</span><span class=o>=</span><span class=mf>0.4582167411327398</span><span class=p>,</span>  <span class=c1># Lower bound of 95% confidence interval</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>    <span class=n>ci_upper</span><span class=o>=</span><span class=mf>0.498828905051887</span>  <span class=c1># Upper bound of 95% confidence interval</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=p>)</span>
</span></code></pre></div> <h3 id=computing-metrics-at-different-k-values>Computing metrics at different k values</h3> <p><code>indomee</code> makes it easy to calculate recall and mrr at different k values:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>from</span> <span class=nn>indomee</span> <span class=kn>import</span> <span class=n>calculate_mrr</span><span class=p>,</span> <span class=n>calculate_recall</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=c1># Basic metric calculation</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=n>mrr</span> <span class=o>=</span> <span class=n>calculate_mrr</span><span class=p>([</span><span class=s2>&quot;apple&quot;</span><span class=p>,</span> <span class=s2>&quot;banana&quot;</span><span class=p>,</span> <span class=s2>&quot;orange&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;banana&quot;</span><span class=p>,</span> <span class=s2>&quot;orange&quot;</span><span class=p>,</span> <span class=s2>&quot;grape&quot;</span><span class=p>])</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;MRR:&quot;</span><span class=p>,</span> <span class=n>mrr</span><span class=p>)</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=c1># &gt; MRR: 0.5</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>recall</span> <span class=o>=</span> <span class=n>calculate_recall</span><span class=p>([</span><span class=s2>&quot;apple&quot;</span><span class=p>,</span> <span class=s2>&quot;banana&quot;</span><span class=p>,</span> <span class=s2>&quot;orange&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;banana&quot;</span><span class=p>])</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Recall:&quot;</span><span class=p>,</span> <span class=n>recall</span><span class=p>)</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=c1># &gt; Recall: 1</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=c1># Metrics at different k values</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=n>metrics</span> <span class=o>=</span> <span class=n>calculate_metrics_at_k</span><span class=p>(</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>    <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;recall&quot;</span><span class=p>],</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=n>preds</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;cat&quot;</span><span class=p>,</span> <span class=s2>&quot;dog&quot;</span><span class=p>,</span> <span class=s2>&quot;fish&quot;</span><span class=p>,</span> <span class=s2>&quot;bird&quot;</span><span class=p>,</span> <span class=s2>&quot;hamster&quot;</span><span class=p>],</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;fish&quot;</span><span class=p>],</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>    <span class=n>k</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=p>)</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>metrics</span><span class=p>:</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;- </span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>metrics</span><span class=p>[</span><span class=n>metric</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=c1># Output:</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=o>-</span> <span class=n>recall</span><span class=o>@</span><span class=mi>1</span> <span class=o>-&gt;</span> <span class=mf>0.0</span>  <span class=c1># Fish not in first position</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=o>-</span> <span class=n>recall</span><span class=o>@</span><span class=mi>2</span> <span class=o>-&gt;</span> <span class=mf>0.0</span>  <span class=c1># Fish not in first two positions</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=o>-</span> <span class=n>recall</span><span class=o>@</span><span class=mi>3</span> <span class=o>-&gt;</span> <span class=mf>1.0</span>  <span class=c1># Fish found at position 3</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=o>-</span> <span class=n>recall</span><span class=o>@</span><span class=mi>4</span> <span class=o>-&gt;</span> <span class=mf>1.0</span>  <span class=c1># Fish still found when looking at top 4</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=o>-</span> <span class=n>recall</span><span class=o>@</span><span class=mi>5</span> <span class=o>-&gt;</span> <span class=mf>1.0</span>  <span class=c1># Fish still found when looking at top 5</span>
</span></code></pre></div> <h3 id=working-with-raw-bootstrap-data>Working with Raw Bootstrap Data</h3> <p>What makes indomee really powerful is that we can bootstrap not with the mean of the results but the raw data itself. This allows us to:</p> <ol> <li>Do a single bootstrap with <code>bootstrap_sample</code></li> <li>Do multiple bootstraps with <code>bootstrap</code></li> </ol> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Single bootstrap sample</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>result</span> <span class=o>=</span> <span class=n>bootstrap_sample</span><span class=p>(</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=n>preds</span><span class=o>=</span><span class=p>[[</span><span class=s2>&quot;a&quot;</span><span class=p>,</span> <span class=s2>&quot;b&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;c&quot;</span><span class=p>,</span> <span class=s2>&quot;d&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;e&quot;</span><span class=p>,</span> <span class=s2>&quot;f&quot;</span><span class=p>]],</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=n>labels</span><span class=o>=</span><span class=p>[[</span><span class=s2>&quot;a&quot;</span><span class=p>,</span> <span class=s2>&quot;b&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;c&quot;</span><span class=p>,</span> <span class=s2>&quot;d&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;e&quot;</span><span class=p>,</span> <span class=s2>&quot;f&quot;</span><span class=p>]],</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=n>sample_size</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;recall&quot;</span><span class=p>],</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>    <span class=n>k</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=p>)</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=c1># Multiple bootstraps</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=n>result</span> <span class=o>=</span> <span class=n>bootstrap</span><span class=p>(</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>    <span class=n>preds</span><span class=o>=</span><span class=p>[[</span><span class=s2>&quot;a&quot;</span><span class=p>,</span> <span class=s2>&quot;b&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;c&quot;</span><span class=p>,</span> <span class=s2>&quot;d&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;e&quot;</span><span class=p>,</span> <span class=s2>&quot;f&quot;</span><span class=p>]],</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>    <span class=n>labels</span><span class=o>=</span><span class=p>[[</span><span class=s2>&quot;a&quot;</span><span class=p>,</span> <span class=s2>&quot;b&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;c&quot;</span><span class=p>,</span> <span class=s2>&quot;d&quot;</span><span class=p>],</span> <span class=p>[</span><span class=s2>&quot;e&quot;</span><span class=p>,</span> <span class=s2>&quot;f&quot;</span><span class=p>]],</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>    <span class=n>sample_size</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>    <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;recall&quot;</span><span class=p>],</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>    <span class=n>k</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=p>)</span>
</span></code></pre></div> <p>The result gives us access to:</p> <ol> <li>The raw samples used in each bootstrap iteration</li> <li>The metrics calculated for each iteration</li> <li>Summary statistics across all iterations</li> </ol> <p>This makes it easy to do more advanced analysis depending on your specific use case.</p> <h2 id=testing-for-statistical-significance>Testing for Statistical Significance</h2> <p>The t-test is a statistical method that helps us determine if the differences we observe between two methods are statistically significant or just due to random chance.</p> <p>When we look at our bootstrap plots, we can see some overlap in the confidence intervals between methods. While this gives us a visual indication, the t-test provides a formal statistical framework to quantify this difference:</p> <ol> <li> <p>The t-test calculates a t-statistic and p-value. The t-statistic measures how many standard deviations the difference between means is from zero while the p-value tells us the probability of observing such a difference if there was actually no real difference between the methods.</p> </li> <li> <p>We use a paired t-test here because our measurements are related (same queries used for each method) and each data point in one method has a natural pairing with a data point in the other method. This helps control for query-specific variations.</p> </li> </ol> <p>First, let's see the manual implementation:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>ttest_rel</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=c1># Calculate the mean for each method</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>method_1</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s2>&quot;method_1&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>method_2</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s2>&quot;method_2&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=n>baseline</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s2>&quot;baseline&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=n>t_stat_baseline_method1</span><span class=p>,</span> <span class=n>p_val_baseline_method1</span> <span class=o>=</span> <span class=n>ttest_rel</span><span class=p>(</span><span class=n>baseline</span><span class=p>,</span> <span class=n>method_1</span><span class=p>)</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=n>t_stat_baseline_method2</span><span class=p>,</span> <span class=n>p_val_baseline_method2</span> <span class=o>=</span> <span class=n>ttest_rel</span><span class=p>(</span><span class=n>baseline</span><span class=p>,</span> <span class=n>method_2</span><span class=p>)</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=n>t_stat_method1_method2</span><span class=p>,</span> <span class=n>p_val_method1_method2</span> <span class=o>=</span> <span class=n>ttest_rel</span><span class=p>(</span><span class=n>method_1</span><span class=p>,</span> <span class=n>method_2</span><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=c1># Create a DataFrame with the t-test results</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=n>results_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>    <span class=p>{</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>        <span class=s2>&quot;Comparison&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;Baseline vs M1&quot;</span><span class=p>,</span> <span class=s2>&quot;Baseline vs M2&quot;</span><span class=p>,</span> <span class=s2>&quot;M1 vs M2&quot;</span><span class=p>],</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>        <span class=s2>&quot;T statistic&quot;</span><span class=p>:</span> <span class=p>[</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>            <span class=n>t_stat_baseline_method1</span><span class=p>,</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>            <span class=n>t_stat_baseline_method2</span><span class=p>,</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>            <span class=n>t_stat_method1_method2</span><span class=p>,</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>        <span class=p>],</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>        <span class=s2>&quot;P Value&quot;</span><span class=p>:</span> <span class=p>[</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a>            <span class=n>p_val_baseline_method1</span><span class=p>,</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>            <span class=n>p_val_baseline_method2</span><span class=p>,</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a>            <span class=n>p_val_method1_method2</span><span class=p>,</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a>        <span class=p>],</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a>    <span class=p>}</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=p>)</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=c1># Format the numeric columns</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=n>results_df</span><span class=p>[</span><span class=s2>&quot;T statistic&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>results_df</span><span class=p>[</span><span class=s2>&quot;T statistic&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=n>results_df</span><span class=p>[</span><span class=s2>&quot;P Value&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>results_df</span><span class=p>[</span><span class=s2>&quot;P Value&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{:.2e}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>)</span>
</span></code></pre></div> <h3 id=simplifying-t-tests-with-indomee>Simplifying t-tests with <code>indomee</code></h3> <p>With indomee, running t-tests is straightforward. Better yet, we automatically do a pairwise comparison for all of the methods you pass in with the option for custom labels for each method.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>from</span> <span class=nn>indomee</span> <span class=kn>import</span> <span class=n>perform_t_tests</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=n>results</span> <span class=o>=</span> <span class=n>perform_t_tests</span><span class=p>(</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>baseline</span><span class=p>,</span> <span class=n>method_1</span><span class=p>,</span> <span class=n>method_2</span><span class=p>,</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Baseline&quot;</span><span class=p>,</span> <span class=s2>&quot;Method 1&quot;</span><span class=p>,</span> <span class=s2>&quot;Method 2&quot;</span><span class=p>],</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=n>paired</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=p>)</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=nb>print</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>    <span class=n>Comparison</span>  <span class=n>T</span> <span class=n>statistic</span>  <span class=n>P</span> <span class=n>Value</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=n>Baseline</span> <span class=n>vs</span> <span class=n>M1</span>        <span class=o>-</span><span class=mf>7.42</span> <span class=mf>3.30e-12</span>  <span class=c1># Highly significant difference</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=n>Baseline</span> <span class=n>vs</span> <span class=n>M2</span>        <span class=o>-</span><span class=mf>6.91</span> <span class=mf>6.55e-11</span>  <span class=c1># Highly significant difference</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>      <span class=n>M1</span> <span class=n>vs</span> <span class=n>M2</span>        <span class=o>-</span><span class=mf>1.59</span> <span class=mf>1.14e-01</span>  <span class=c1># Not significant (p &gt; 0.05)</span>
</span></code></pre></div> <p>This produces a clean DataFrame showing:</p> <ul> <li>The methods being compared</li> <li>T-statistics and p-values</li> <li>Whether differences are significant at p &lt; 0.05</li> </ul> <h2 id=conclusion>Conclusion</h2> <p>As LLMs continue to evolve with better context understanding and longer context windows, having robust evaluation of retrieval systems becomes even more crucial. Statistical analysis helps ensure that improvements are real and not just random chance.</p> <p>Without being able to perform statistical analysis, you might invest in a new system upgrade that's outperformed your old one by pure chance. That's a huge time sink and a waste of resources for any company looking to move fast and build a great product.</p> <p><code>indomee</code> makes it easy to implement statistical analysis for your retrieval pipeline. Give it a try today with <code>pip install indomee</code>.</p> <!-- Add social sharing buttons --> <div class=md-social-share style="margin: 2rem 0; text-align: center"> <span class=md-social-share__label style="display: block; margin-bottom: 1rem; font-weight: 500">Share this post:</span> <div class=md-social-share__buttons style="display: flex; gap: 1rem; justify-content: center"> <a href="https://x.com/intent/tweet?text=Are%20your%20eval%20improvements%20just%20pure%20chance%3F&url=https://ivanleo.com/blog/are-your-eval-improvements-just-pure-chance.html" class=md-social-share__button style="
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background: #000;
            color: #fff;
            text-decoration: none;
            transition: opacity 0.2s;
          " target=_blank rel=noopener> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"/></svg> <span style="margin-left: 0.5rem">Share on X</span> </a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ivanleo.com/blog/are-your-eval-improvements-just-pure-chance.html&title=Are%20your%20eval%20improvements%20just%20pure%20chance%3F&summary=&source=" class=md-social-share__button style="
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background: #0077b5;
            color: #fff;
            text-decoration: none;
            transition: opacity 0.2s;
          " target=_blank rel=noopener> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.06 2.06 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065m1.782 13.019H3.555V9h3.564zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0z"/></svg> <span style="margin-left: 0.5rem">Share on LinkedIn</span> </a> </div> </div> <div class=newsletter-section style="margin: 2rem 0"> <script async data-uid=b184c2f91e src=https://ivan-leo.kit.com/b184c2f91e/index.js></script> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.copy", "content.code.annotate", "navigation.tabs", "toc.follow", "navigation.path"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.83f73b43.min.js></script> <script src=../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>